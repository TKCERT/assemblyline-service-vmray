name: VMRay
version: $SERVICE_TAG
description: VMRay service

# Regex defining the types of files the service accepts and rejects
accepts: .*
rejects: empty|metadata/.*

# At which stage the service should run (one of FILTER, EXTRACT, CORE, SECONDARY, POST, REVIEW)
# NOTE: Stages are executed in the order defined in the list
stage: CORE
# Which category the service is part of (one of Antivirus, Dynamic Analysis, External, Extraction, Filtering, Internet Connected, Networking, Static Analysis)
category: Dynamic Analysis

# Does the service require access to the file to perform its task
# If set to false, the service will only have access to the file metadata (e.g. Hashes, size, type, ...)
file_required: true
# Maximum execution time the service has before it's considered to be timed out
timeout: 600

# is the service enabled by default
enabled: true

# avoid recursion on extracted files
recursion_prevention:
  - Dynamic Analysis

# Service configuration block (dictionary of config variables)
#     NOTE: The key names can be anything and the value can be of any types
config:
  vmray_service_url: ""
  vmray_service_api_key: ""
  vmray_service_shareable: true
  vmray_service_reanalyze: true
  vmray_service_max_jobs: 1
  vmray_debug_add_json: false
  vmray_debug_sample_id: 0
  verify_certificate: true

# Submission params block:
#     A list of submission param object that define parameters
#     that the user can change about the service for each of its scans
#     SUPPORTED TYPES: bool, int, str, list
# submission_params:
#   - default: ""
#     name: password
#     type: str
#     value: ""
#   - default: false
#     name: extra_work
#     type: bool
#     value: false

# Service heuristic blocks: List of heuristic objects that define the different heuristics used in the service
# heuristics:
#   - description: This is a demo heuristic
#     filetype: "*"
#     heur_id: 1
#     name: Demo
#     score: 100
heuristics:
  - heur_id: 4
    name: Malicious verdict
    score: 1000
    filetype: '*'
    description: VMRay analysis verdict is malicious.

  - heur_id: 3
    name: Suspicious verdict
    score: 500
    filetype: '*'
    description: VMRay analysis verdict is suspicious.

  - heur_id: 0
    name: Clean verdict
    score: 0
    filetype: '*'
    description: VMRay analysis verdict is clean.

# Docker configuration block which defines:
#  - the name of the docker container that will be created
#  - CPU and ram allocation by the container
docker_config:
  allow_internet_access: true
  image: ${REGISTRY}ghcr.io/tkcert/assemblyline-service-vmray:$SERVICE_TAG
  cpu_cores: 1.0
  ram_mb_min: 512
  ram_mb: 1024
